<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Authentiometer</title>
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; margin: 24px; max-width: 980px; }
    h1 { margin: 0 0 8px; }
    .muted { color: #666; font-size: 0.95rem; }
    .row { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
    .card { border: 1px solid #ddd; border-radius: 10px; padding: 14px; margin: 12px 0; }
    label { display: block; font-weight: 600; margin: 10px 0 6px; }
    input[type="text"], input[type="password"], textarea, select {
      width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 8px; font: inherit;
      box-sizing: border-box;
    }
    textarea { min-height: 140px; resize: vertical; }
    .inline { display: flex; gap: 10px; align-items: center; flex-wrap: wrap; }
    .inline > * { margin: 6px 0; }
    button { padding: 10px 14px; border: 0; border-radius: 8px; cursor: pointer; font-weight: 700; }
    button.primary { background: #111; color: #fff; }
    button.secondary { background: #eee; }
    button:disabled { opacity: 0.5; cursor: not-allowed; }
    .pill { display: inline-block; padding: 3px 8px; border: 1px solid #ddd; border-radius: 999px; font-size: 0.85rem; }
    .hidden { display: none; }
    pre { background: #0b1020; color: #e7e7e7; padding: 12px; border-radius: 10px; overflow: auto; }
    .error { color: #b00020; font-weight: 700; }
    .ok { color: #0a7a2f; font-weight: 700; }
    details summary { cursor: pointer; font-weight: 700; }
    hr { border: 0; border-top: 1px solid #eee; margin: 12px 0; }
  </style>
</head>
<body>
  <h1>Authentiometer</h1>
  <p class="muted">
    Par d√©faut : <span class="pill">Gemini + YouTube</span> (extraction/transcript auto via ‚Äúvideo file part‚Äù) ‚Ä¢ Option :
    <span class="pill">Groq + texte</span><br/>
    Aucune donn√©e n‚Äôest stock√©e c√¥t√© serveur. Les cl√©s peuvent √™tre m√©moris√©es localement si tu coches ‚ÄúM√©moriser‚Äù.
  </p>

  <div class="card">
    <div class="row">
      <div>
        <label for="mode">Mode</label>
        <select id="mode">
          <option value="gemini" selected>Gemini + URL YouTube (d√©faut)</option>
          <option value="groq">Groq + texte (transcription ou non)</option>
        </select>

        <label for="youtubeUrl">URL YouTube</label>
        <input id="youtubeUrl" type="text" placeholder="https://www.youtube.com/watch?v=..." />

        <div class="inline">
          <div style="flex:1">
            <label for="apiKey">Cl√© API</label>
            <input id="apiKey" type="password" placeholder="Cl√© Gemini (d√©faut) / Cl√© Groq (mode Groq)" />
          </div>
          <div>
            <label>&nbsp;</label>
            <button id="toggleKey" class="secondary" type="button">üëÅÔ∏è Afficher</button>
          </div>
        </div>

        <div class="inline">
          <label class="inline"><input type="checkbox" id="rememberKey" /> M√©moriser la cl√© (localStorage)</label>
          <button id="forgetKeyBtn" class="secondary" type="button">Oublier</button>
        </div>

        <div class="inline">
          <button id="loadModelsBtn" class="secondary" type="button">Charger mod√®les (selon mode)</button>
          <span id="modelsHint" class="muted"></span>
        </div>
      </div>

      <div>
        <div id="groqTextBlock" class="hidden">
          <label for="freeText">Texte (optionnel)</label>
          <textarea id="freeText" placeholder="Colle une transcription, un r√©sum√©, ou n'importe quel texte. Si vide : analyse tr√®s limit√©e."></textarea>
        </div>

        <label>Options</label>
        <div class="inline">
          <label class="inline"><input type="checkbox" id="optAuth" checked /> Authenticity</label>
          <label class="inline"><input type="checkbox" id="optFact" checked /> Fact-checking</label>
          <label class="inline"><input type="checkbox" id="optSci" checked /> Scientific soundness</label>
          <label class="inline"><input type="checkbox" id="optCautious" checked /> Mode prudent</label>
        </div>

        <label for="uiLang">Langue de sortie</label>
        <select id="uiLang">
          <option value="fr" selected>Fran√ßais</option>
          <option value="en">English</option>
        </select>

        <label for="modelChoice">Mod√®le</label>
        <select id="modelChoice">
          <option value="" selected>‚Äî Clique ‚ÄúCharger mod√®les‚Äù ‚Äî</option>
        </select>

        <div class="inline" style="margin-top:10px">
          <button id="analyzeBtn" class="primary" type="button">Analyser</button>
          <button id="clearBtn" class="secondary" type="button">Effacer</button>
        </div>

        <p class="muted" style="margin-top:10px">
          Mode Gemini : 2 √©tapes (1) extraction/transcript via la vid√©o YouTube (2) analyse Authentiometer sur le texte extrait.<br/>
          Mode Groq : analyse uniquement sur le texte fourni (pas de r√©cup√©ration YouTube).
        </p>
      </div>
    </div>

    <div id="status" class="muted" style="margin-top:10px"></div>
    <div id="err" class="error" style="margin-top:10px"></div>
  </div>

  <div class="card">
    <h2 style="margin-top:0">R√©sultat</h2>
    <div id="summary"></div>

    <details style="margin-top:10px">
      <summary>Texte extrait (Gemini)</summary>
      <pre id="extractedText">(vide)</pre>
    </details>

    <details style="margin-top:10px" open>
      <summary>JSON brut</summary>
      <pre id="rawJson">{}</pre>
    </details>
  </div>

  <script src="./app.js"></script>
</body>
</html>
