<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Authentiometer</title>
  <link rel="stylesheet" href="/authentiometer/styles.css" />
</head>
<body>
  <header class="topbar">
    <div class="brand">
      <div class="logo">A</div>
      <div>
        <div class="brand-title">Authentiometer</div>
        <div class="brand-sub">Aide √† la d√©cision de confiance pour contenus YouTube</div>
      </div>
    </div>
    <div class="topbar-actions">
      <button id="helpBtn" class="btn secondary" type="button">Aide</button>
    </div>
  </header>

  <main class="container">
    <!-- Intro / Home explanations (shown until user checks "do not show") -->
    <section id="introCard" class="card">
      <h2>Bienvenue</h2>
      <p class="muted">
        Authentiometer t‚Äôaide √† d√©cider <b>quand</b> et <b>pourquoi</b> accorder ta confiance √† une vid√©o.
        Il ne donne pas un verdict ‚Äúvrai/faux‚Äù : il propose un <b>profil</b> (authenticit√©, plausibilit√© factuelle, solidit√© scientifique),
        avec incertitudes et limites.
      </p>

      <div class="grid2">
        <div class="pillcard">
          <h3>Mode Gemini + YouTube</h3>
          <p class="muted">
            Gemini tente d‚Äôextraire le contenu depuis l‚ÄôURL YouTube, puis l‚Äôanalyse.
            Si la vid√©o est trop longue / inaccessible, l‚Äôoutil bascule sur un mode prudent (r√©sum√© ‚Üí analyse) ou s‚Äôarr√™te proprement.
          </p>
        </div>
        <div class="pillcard">
          <h3>Mode Groq + Texte</h3>
          <p class="muted">
            Groq analyse uniquement le texte fourni (transcription, r√©sum√©, notes).
            Si c‚Äôest trop long, l‚Äôoutil condense automatiquement puis analyse.
          </p>
        </div>
      </div>

      <div class="row">
        <label class="checkbox">
          <input type="checkbox" id="hideIntroChk" />
          Ne plus afficher ces explications
        </label>
      </div>
    </section>

    <section class="card">
      <div class="grid2">
        <div>
          <label for="mode">Mode</label>
          <select id="mode">
            <option value="gemini" selected>Gemini + URL YouTube (d√©faut)</option>
            <option value="groq">Groq + Texte</option>
          </select>

          <label for="youtubeUrl">URL YouTube</label>
          <input id="youtubeUrl" type="text" placeholder="https://www.youtube.com/watch?v=..." />

          <div class="row">
            <label class="checkbox">
              <input type="checkbox" id="optCautious" checked />
              Mode prudent (recommand√©)
            </label>
          </div>

          <label for="uiLang">Langue de sortie</label>
          <select id="uiLang">
            <option value="fr" selected>Fran√ßais</option>
            <option value="en">English</option>
          </select>
        </div>

        <div>
          <h3 style="margin-top:0">Cl√©s API</h3>

          <label for="geminiKey">Cl√© Gemini</label>
          <div class="keyline">
            <input id="geminiKey" type="password" placeholder="AIza..." />
            <button id="toggleGeminiKey" class="btn secondary" type="button">üëÅÔ∏è</button>
          </div>
          <div class="row">
            <label class="checkbox">
              <input type="checkbox" id="rememberGemini" />
              M√©moriser (localStorage)
            </label>
            <button id="forgetGemini" class="btn secondary" type="button">Oublier</button>
          </div>

          <label for="groqKey">Cl√© Groq</label>
          <div class="keyline">
            <input id="groqKey" type="password" placeholder="gsk_..." />
            <button id="toggleGroqKey" class="btn secondary" type="button">üëÅÔ∏è</button>
          </div>
          <div class="row">
            <label class="checkbox">
              <input type="checkbox" id="rememberGroq" />
              M√©moriser (localStorage)
            </label>
            <button id="forgetGroq" class="btn secondary" type="button">Oublier</button>
          </div>

          <hr/>

          <label>Indices</label>
          <div class="row wrap">
            <label class="checkbox"><input type="checkbox" id="optAuth" checked /> Authenticity</label>
            <label class="checkbox"><input type="checkbox" id="optFact" checked /> Fact-checking</label>
            <label class="checkbox"><input type="checkbox" id="optSci" checked /> Scientific soundness</label>
          </div>
        </div>
      </div>

      <hr/>

      <div class="grid2">
        <div>
          <label for="modelsGemini">Mod√®le Gemini</label>
          <div class="row">
            <select id="modelsGemini">
              <option value="" selected>‚Äî Charger la liste ‚Äî</option>
            </select>
            <button id="loadGeminiModels" class="btn secondary" type="button">Charger</button>
          </div>

          <label for="modelsGroq">Mod√®le Groq</label>
          <div class="row">
            <select id="modelsGroq">
              <option value="" selected>‚Äî Charger la liste ‚Äî</option>
            </select>
            <button id="loadGroqModels" class="btn secondary" type="button">Charger</button>
          </div>

          <p id="modelsHint" class="muted"></p>
        </div>

        <div id="groqTextBlock" class="hidden">
          <label for="freeText">Texte (Groq) ‚Äî transcription, r√©sum√©, notes‚Ä¶</label>
          <textarea id="freeText" placeholder="Colle un texte ici (sinon l'analyse Groq sera limit√©e)."></textarea>
          <p class="muted">Astuce : un bon r√©sum√© vaut souvent mieux qu‚Äôune transcription brute √©norme.</p>
        </div>
      </div>

      <div class="row">
        <button id="analyzeBtn" class="btn primary" type="button">Analyser</button>
        <button id="clearBtn" class="btn secondary" type="button">Effacer</button>
      </div>

      <div id="status" class="muted"></div>
      <div id="err" class="error"></div>
    </section>

    <section class="card">
      <h2>R√©sultats</h2>

      <div id="summary"></div>

      <details>
        <summary>Texte utilis√© (apr√®s extraction/condensation)</summary>
        <pre id="usedText">(vide)</pre>
      </details>

      <details open>
        <summary>JSON brut</summary>
        <pre id="rawJson">{}</pre>
      </details>
    </section>
  </main>

  <!-- Help modal -->
  <dialog id="helpDialog" class="modal">
    <div class="modal-inner">
      <div class="modal-head">
        <h3>Aide</h3>
        <button id="closeHelp" class="btn secondary" type="button">Fermer</button>
      </div>
      <div class="modal-body">
        <p>
          <b>Authentiometer</b> fournit un profil de confiance (pas un verdict). Les trois axes sont ind√©pendants :
          <b>Authenticity</b>, <b>Fact-checking</b>, <b>Scientific soundness</b>.
        </p>
        <ul>
          <li><b>Gemini + YouTube</b> : extraction/texte depuis la vid√©o puis analyse. Certaines vid√©os peuvent √™tre inaccessibles.</li>
          <li><b>Groq + Texte</b> : analyse uniquement sur le texte fourni.</li>
          <li>Si le contenu est trop long : l‚Äôoutil <b>condense</b> automatiquement, sinon il s‚Äôarr√™te proprement avec une raison claire.</li>
          <li>Les cl√©s peuvent √™tre m√©moris√©es en localStorage (optionnel).</li>
        </ul>
      </div>
    </div>
  </dialog>

  <script type="module" src="/authentiometer/app_authentiometer.js"></script>
</body>
</html>
